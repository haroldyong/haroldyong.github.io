### practise in bandwidth design


## 1. 规划经验


1. QPS规划

每秒查询率QPS是对一个特定的查询服务器在规定时间内所处理流量多少的衡量标准，在因特网上，作为域名系统服务器的机器的性能经常用每秒查询率来衡量。

原理：每天80%的访问集中在20%的时间里，这20%时间叫做峰值时间
公式：( 总PV数 * 80% ) / ( 每天秒数 * 20% ) = 峰值时间每秒请求数(QPS)
机器：峰值时间每秒QPS / 单台机器的QPS = 需要的机器

问：每天300w PV 的在单台机器上，这台机器需要多少QPS？
答：( 3000000 * 0.8 ) / (86400 * 0.2 ) = 139 (QPS)

问：如果一台机器的QPS是58，需要几台机器来支持？
答：139 / 58 = 3

顺便一提：
800Gbps=100G/s
因为一个字节等于8bit

from https://blog.51cto.com/u_13013670/1944040


2. TPS规划

理解一： 80%的业务量在20%的时间里完成
理解二： 80%的访问请求，最终落在20%的数据上
理解三： 80%的用户会在20%的时间内集中进行操作
举例：
用户登录场景：早高峰时段，8：50---9：10，5000坐席上线登录。
业务量：5000个
时间：20x60=1200秒
吞吐量=80%x业务量/(20%*时间)=4000/240=16.7/秒
而并非5000/1200=4.1/秒
实际上，登录请求数分布是一个正态分布，最高峰时肯定比4.1/秒更高，高峰段实际上完成了80%的业务量，却只花了20%的时间。

注意：

80/20原则计算的是系统要达到的处理能力（吞吐量或者TPS），不是并发用户数。

知道在线用户数或者注册用户数或者PV，就可用80/20原则预估出要达到的TPS。
公式： PV*80% / 3600*20% =TPS的值
3600代表1个小时3600秒

https://blog.51cto.com/u_5731674/2162525
